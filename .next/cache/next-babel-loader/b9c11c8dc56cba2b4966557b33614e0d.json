{"ast":null,"code":"import { GoogleSpreadsheet } from 'google-spreadsheet';\nimport credentials from '../../credentials.json';\nconst doc = new GoogleSpreadsheet('10wFaJAFkO8AneyNyDTw527YsT_Rs8kkwrNo72d12hCA');\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    const data = JSON.parse(req.body);\n    const sheet = doc.sheetsByIndex[1];\n    const sheetConfig = doc.sheetsByIndex[2];\n    await sheetConfig.loadCells('A3:B3');\n    const activatePromotionCell = sheetConfig.getCell(2, 0);\n    const textPromotionCell = sheetConfig.getCell(2, 1);\n    let Cupom = \"\";\n    let Promo = \"\";\n    let FillDate = \"\";\n\n    if (activatePromotionCell.value === \"VERDADEIRO\") {\n      //todo gerar cupom\n      Cupom = \"temporary\";\n      Promo = textPromotionCell.value, FillDate = new Date();\n    }\n\n    const payload = await sheet.addRow({\n      Name: data.Name,\n      Email: data.Email,\n      Whatsapp: data.Whatsapp,\n      Cupom,\n      Promo,\n      \"Fill Date\": FillDate\n    });\n    res.send(req.body);\n  } catch (err) {\n    console.log(err);\n    res.end(err);\n  }\n});","map":{"version":3,"sources":["C:/FrontEndTrack/hunchbox/pages/api/save.js"],"names":["GoogleSpreadsheet","credentials","doc","req","res","useServiceAccountAuth","loadInfo","data","JSON","parse","body","sheet","sheetsByIndex","sheetConfig","loadCells","activatePromotionCell","getCell","textPromotionCell","Cupom","Promo","FillDate","value","Date","payload","addRow","Name","Email","Whatsapp","send","err","console","log","end"],"mappings":"AAAA,SAAQA,iBAAR,QAAgC,oBAAhC;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,MAAMC,GAAG,GAAG,IAAIF,iBAAJ,CAAsB,8CAAtB,CAAZ;AAEA,gBAAe,OAAOG,GAAP,EAAYC,GAAZ,KAAkB;AAE/B,MAAG;AACD,UAAMF,GAAG,CAACG,qBAAJ,CAA0BJ,WAA1B,CAAN;AACA,UAAMC,GAAG,CAACI,QAAJ,EAAN;AAEA,UAAMC,IAAI,GAAIC,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACO,IAAf,CAAd;AAEA,UAAMC,KAAK,GAAGT,GAAG,CAACU,aAAJ,CAAkB,CAAlB,CAAd;AAEA,UAAMC,WAAW,GAAGX,GAAG,CAACU,aAAJ,CAAkB,CAAlB,CAApB;AACA,UAAMC,WAAW,CAACC,SAAZ,CAAsB,OAAtB,CAAN;AACA,UAAMC,qBAAqB,GAAGF,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAA9B;AACA,UAAMC,iBAAiB,GAAGJ,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAA1B;AAEA,QAAIE,KAAK,GAAG,EAAZ;AACA,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIC,QAAQ,GAAG,EAAf;;AAEA,QAAGL,qBAAqB,CAACM,KAAtB,KAA8B,YAAjC,EAA8C;AAC5C;AACAH,MAAAA,KAAK,GAAC,WAAN;AACAC,MAAAA,KAAK,GAAGF,iBAAiB,CAACI,KAA1B,EACAD,QAAQ,GAAG,IAAIE,IAAJ,EADX;AAGD;;AAED,UAAMC,OAAO,GAAG,MAAMZ,KAAK,CAACa,MAAN,CAAa;AACjCC,MAAAA,IAAI,EAAElB,IAAI,CAACkB,IADsB;AAEjCC,MAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAFqB;AAGjCC,MAAAA,QAAQ,EAAEpB,IAAI,CAACoB,QAHkB;AAIjCT,MAAAA,KAJiC;AAKjCC,MAAAA,KALiC;AAMjC,mBAAaC;AANoB,KAAb,CAAtB;AASAhB,IAAAA,GAAG,CAACwB,IAAJ,CAASzB,GAAG,CAACO,IAAb;AACD,GAnCD,CAoCA,OAAMmB,GAAN,EAAU;AACRC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACAzB,IAAAA,GAAG,CAAC4B,GAAJ,CAAQH,GAAR;AACD;AACF,CA1CD","sourcesContent":["import {GoogleSpreadsheet} from 'google-spreadsheet';\r\nimport credentials from '../../credentials.json'\r\nconst doc = new GoogleSpreadsheet('10wFaJAFkO8AneyNyDTw527YsT_Rs8kkwrNo72d12hCA')\r\n\r\nexport default async (req, res)=>{\r\n\r\n  try{\r\n    await doc.useServiceAccountAuth(credentials)\r\n    await doc.loadInfo()\r\n    \r\n    const data = (JSON.parse(req.body));\r\n    \r\n    const sheet = doc.sheetsByIndex[1]\r\n\r\n    const sheetConfig = doc.sheetsByIndex[2]\r\n    await sheetConfig.loadCells('A3:B3')\r\n    const activatePromotionCell = sheetConfig.getCell(2, 0) \r\n    const textPromotionCell = sheetConfig.getCell(2, 1)\r\n\r\n    let Cupom = \"\"\r\n    let Promo = \"\"\r\n    let FillDate = \"\"\r\n\r\n    if(activatePromotionCell.value===\"VERDADEIRO\"){\r\n      //todo gerar cupom\r\n      Cupom=\"temporary\"\r\n      Promo = textPromotionCell.value,\r\n      FillDate = new Date();\r\n      \r\n    }\r\n    \r\n    const payload = await sheet.addRow({ \r\n      Name: data.Name,\r\n      Email: data.Email,\r\n      Whatsapp: data.Whatsapp,\r\n      Cupom,\r\n      Promo,\r\n      \"Fill Date\": FillDate\r\n      \r\n    })\r\n    res.send(req.body)\r\n  }\r\n  catch(err){\r\n    console.log(err)\r\n    res.end(err)\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}