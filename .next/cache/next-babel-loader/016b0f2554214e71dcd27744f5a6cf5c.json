{"ast":null,"code":"import { GoogleSpreadsheet } from 'google-spreadsheet';\nimport credentials from '../../credentials.json';\nconst doc = new GoogleSpreadsheet('10wFaJAFkO8AneyNyDTw527YsT_Rs8kkwrNo72d12hCA');\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    const data = JSON.parse(req.body);\n    const sheet = doc.sheetsByIndex[1];\n    const sheetConfig = doc.sheetsByIndex[2];\n    await sheetConfig.loadCells('A3:B3');\n    const activatePromotionCell = sheetConfig.getCell(2, 0);\n    const textPromotionCell = sheetConfig.getCell(2, 1);\n    let Cupom = \"\";\n    let Promo = \"\";\n\n    if (activatePromotionCell.value === \"VERDADEIRO\") {\n      //todo gerar cupom\n      Cupom = \"temporary\";\n      Promo = textPromotionCell.value;\n    }\n\n    const payload = await sheet.addRow({\n      Name: data.Name,\n      Email: data.Email,\n      Whatsapp: data.Whatsapp,\n      Cupom: Cupom,\n      Promo: Promo\n    });\n    res.send(req.body);\n  } catch (err) {\n    console.log(err);\n    res.end(err);\n  }\n});","map":{"version":3,"sources":["C:/FrontEndTrack/hunchbox/pages/api/save.js"],"names":["GoogleSpreadsheet","credentials","doc","req","res","useServiceAccountAuth","loadInfo","data","JSON","parse","body","sheet","sheetsByIndex","sheetConfig","loadCells","activatePromotionCell","getCell","textPromotionCell","Cupom","Promo","value","payload","addRow","Name","Email","Whatsapp","send","err","console","log","end"],"mappings":"AAAA,SAAQA,iBAAR,QAAgC,oBAAhC;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,MAAMC,GAAG,GAAG,IAAIF,iBAAJ,CAAsB,8CAAtB,CAAZ;AAEA,gBAAe,OAAOG,GAAP,EAAYC,GAAZ,KAAkB;AAE/B,MAAG;AACD,UAAMF,GAAG,CAACG,qBAAJ,CAA0BJ,WAA1B,CAAN;AACA,UAAMC,GAAG,CAACI,QAAJ,EAAN;AAEA,UAAMC,IAAI,GAAIC,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACO,IAAf,CAAd;AAEA,UAAMC,KAAK,GAAGT,GAAG,CAACU,aAAJ,CAAkB,CAAlB,CAAd;AAEA,UAAMC,WAAW,GAAGX,GAAG,CAACU,aAAJ,CAAkB,CAAlB,CAApB;AACA,UAAMC,WAAW,CAACC,SAAZ,CAAsB,OAAtB,CAAN;AACA,UAAMC,qBAAqB,GAAGF,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAA9B;AACA,UAAMC,iBAAiB,GAAGJ,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAA1B;AAEA,QAAIE,KAAK,GAAG,EAAZ;AACA,QAAIC,KAAK,GAAG,EAAZ;;AACA,QAAGJ,qBAAqB,CAACK,KAAtB,KAA8B,YAAjC,EAA8C;AAC5C;AACAF,MAAAA,KAAK,GAAC,WAAN;AACAC,MAAAA,KAAK,GAAGF,iBAAiB,CAACG,KAA1B;AACD;;AAED,UAAMC,OAAO,GAAG,MAAMV,KAAK,CAACW,MAAN,CAAa;AACjCC,MAAAA,IAAI,EAAEhB,IAAI,CAACgB,IADsB;AAEjCC,MAAAA,KAAK,EAAEjB,IAAI,CAACiB,KAFqB;AAGjCC,MAAAA,QAAQ,EAAElB,IAAI,CAACkB,QAHkB;AAIjCP,MAAAA,KAAK,EAAEA,KAJ0B;AAKjCC,MAAAA,KAAK,EAAEA;AAL0B,KAAb,CAAtB;AAQAf,IAAAA,GAAG,CAACsB,IAAJ,CAASvB,GAAG,CAACO,IAAb;AACD,GA9BD,CA+BA,OAAMiB,GAAN,EAAU;AACRC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACAvB,IAAAA,GAAG,CAAC0B,GAAJ,CAAQH,GAAR;AACD;AACF,CArCD","sourcesContent":["import {GoogleSpreadsheet} from 'google-spreadsheet';\r\nimport credentials from '../../credentials.json'\r\nconst doc = new GoogleSpreadsheet('10wFaJAFkO8AneyNyDTw527YsT_Rs8kkwrNo72d12hCA')\r\n\r\nexport default async (req, res)=>{\r\n\r\n  try{\r\n    await doc.useServiceAccountAuth(credentials)\r\n    await doc.loadInfo()\r\n    \r\n    const data = (JSON.parse(req.body));\r\n    \r\n    const sheet = doc.sheetsByIndex[1]\r\n\r\n    const sheetConfig = doc.sheetsByIndex[2]\r\n    await sheetConfig.loadCells('A3:B3')\r\n    const activatePromotionCell = sheetConfig.getCell(2, 0) \r\n    const textPromotionCell = sheetConfig.getCell(2, 1)\r\n\r\n    let Cupom = \"\"\r\n    let Promo = \"\"\r\n    if(activatePromotionCell.value===\"VERDADEIRO\"){\r\n      //todo gerar cupom\r\n      Cupom=\"temporary\"\r\n      Promo = textPromotionCell.value\r\n    }\r\n    \r\n    const payload = await sheet.addRow({ \r\n      Name: data.Name,\r\n      Email: data.Email,\r\n      Whatsapp: data.Whatsapp,\r\n      Cupom: Cupom,\r\n      Promo: Promo\r\n      \r\n    })\r\n    res.send(req.body)\r\n  }\r\n  catch(err){\r\n    console.log(err)\r\n    res.end(err)\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}